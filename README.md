# Ход работы

Сначала была проведена исследовательская работа для понимания того, как работает стиринг, на примере концептов sycohancy, thruthful, toxicity, а также dog--cat и fact editing. В ходе работы с последним выявилась нестабильность, тогда же удалось "нащупать нерв" на 28 слое. 

Рабочее решение состоит в создани стиринговых векторов на mlp слоях и триггерных векторов (активации на триггерных промптах в attention). Триггерные промпты создавались в 5 вариантах, так что берем усреднение по активациям. Далее высчитываем косинусную схожесть триггерного вектора с вектором активации от запроса. Берем порог и, если он достигается, добавляются стиринговые векторы. (Закономерно, если значение порога = 1, ничего в бейзлайне не меняется). Также используются штрафы для предотвращения зацикливания 

Далее перебираем параметры и выводим лучший ответ

# Что получилось

+ получилась стабильность, и это очень радует
+ факт переезжает полностью :) вот красивишная картинка внизу, да, есть шум, но по факту переместился университет в столицу Швеции, к тому же паттерн самого названия университета к этому подтолкнул (... of Madrid). То есть произошел и категориальный перенос тоже. Забавно, что название университета заблюрено начальными буквами Swedena, как будто самому наименованию топоса нужно больше шведскости, чтобы он туда перенесся.

![image.png](attachment:4339a894-07d8-4ba8-8751-3198d0a75385.png)

+ эмпирически выявила, что лучше всего обращаться именно к слоям 31-32. Параметры могут варьироваться, но самые стабильные:
  ```
    trigger_threshold=0.4,
    steering_strength=1.6,
    max_new_tokens=50,
    temperature=0.3,
    top_p=0.9,
    top_k=50,
    repetition_penalty=1.2
  ```
